{
  "meta": {
    "date": "2026-02-05",
    "author": "Codex",
    "repo": "JasBlogEditor"
  },
  "stack": {
    "frontend": ["React 19", "TypeScript", "Vite 6", "Tailwind CSS 4", "Zustand 5"],
    "desktop": ["Tauri 2", "Rust"],
    "notes": [
      "前端与后端通过 Tauri commands (invoke) 通信",
      "开发端口默认 1422，存在端口冲突问题（strictPort + beforeDevCommand）"
    ]
  },
  "where": {
    "entry": ["src/main.tsx", "src/App.tsx"],
    "state": ["src/store/settingsStore.ts", "src/store/fileStore.ts", "src/store/editorStore.ts"],
    "platform": ["src/platform/tauri.ts", "src/platform/runtime.ts"],
    "services": ["src/services/contentParser.ts", "src/services/contentTemplates.ts"],
    "ui": [
      "src/components/layout/*",
      "src/components/editors/*",
      "src/components/forms/*",
      "src/components/preview/*",
      "src/components/graph/*"
    ],
    "tauri": ["src-tauri/tauri.conf.json", "src-tauri/src/*"],
    "dev-scripts": ["scripts/dev-app.mjs", "scripts/dev-web.mjs", "scripts/dev-port.mjs", "scripts/ensure-dev-port.mjs"]
  },
  "current-implementation": {
    "dev-server": {
      "viteConfig": "vite.config.ts 读取 JAS_DEV_PORT/JAS_HMR_PORT 并配置 server 端口",
      "tauri": "src-tauri/tauri.conf.json 使用 beforeDevCommand 启动 npm run dev:tauri（固定 1422 + strictPort）",
      "autoPortScripts": [
        "npm run dev / dev:app 通过 scripts/dev-port.mjs 探测端口并注入 JAS_DEV_PORT",
        "dev:app 会生成临时 tauri 配置并同步 build.devUrl"
      ]
    },
    "app-architecture": {
      "pattern": "platform -> store -> components 的分层较清晰",
      "notes": [
        "App.tsx 内包含主题/工作区初始化/快捷键注册等多种职责",
        "editorStore.ts 同时包含文件 CRUD + 迷你模式窗口逻辑（职责偏重）"
      ]
    }
  },
  "tests": {
    "status": "未发现现成测试（无 *.test/*, vitest/jest 配置）",
    "current-verification": ["TypeScript: tsc -b", "Build: vite build（npm run build）"]
  },
  "similar-areas": [
    "src/components/layout/DocsSidebar.tsx 与 src/components/layout/JasBlogSidebar.tsx 存在重复的右键菜单/重命名对话框逻辑",
    "src/App.tsx 与 src/utils/theme.ts、src/store/* 的交互模式可抽成 hooks 复用"
  ],
  "observations": [
    "端口冲突：用户直接跑 tauri dev / npm run tauri dev 时会触发 beforeDevCommand（固定端口）而报错",
    "重复逻辑：两个 Sidebar 里右键菜单与重命名弹窗重复，影响可复用性/可读性",
    "耦合点：editorStore 混合窗口管理与文件操作；invokeTauri 的 cmd/args 缺少类型约束"
  ]
}

